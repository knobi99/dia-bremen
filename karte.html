<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a4971">
    <title>Standorte & Karte - Digital im Alter Bremen-Nord</title>
    <meta name="description" content="Interaktive Karte aller Standorte, Sprechstunden und Termine von Digital im Alter Bremen-Nord. Barrierefreie Navigation zu unseren Angeboten.">
    
    <!-- CSS Links -->
    <link rel="stylesheet" href="css/main-styles.css">
    <link rel="stylesheet" href="css/footer-styles.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    
    <!-- Performance Optimierung -->
    <link rel="preload" href="css/main-styles.css" as="style">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    
    <style>
        /* Zus√§tzliche Styles f√ºr die Karte */
        .map-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .a11y-banner {
            background: #e8f4f8;
            border-left: 4px solid var(--hauptblau);
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .a11y-banner strong {
            color: var(--hauptblau);
        }
        
        .toggle-list-btn {
            background: var(--hauptblau);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toggle-list-btn:hover,
        .toggle-list-btn:focus {
            background: #0f3555;
        }
        
        .location-list {
            display: none;
            margin-bottom: 30px;
        }
        
        .location-list.active {
            display: block;
        }
        
        .location-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .location-card h3 {
            color: var(--hauptblau);
            font-size: 20px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .location-card p {
            margin: 8px 0;
            color: #555;
        }
        
        .location-card a {
            color: var(--hauptblau);
            text-decoration: underline;
        }

        .event-badge {
            display: inline-block;
            background: #ffc107;
            color: #000;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .event-badge.upcoming {
            background: var(--beruehigendes-gruen);
            color: white;
        }
        
        .map-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .map-section h2 {
            color: var(--hauptblau);
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .map-instructions {
            background: #fff9e6;
            border: 2px solid #ffc107;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .map-instructions p {
            margin: 5px 0;
            color: #555;
        }
        
        #map {
            height: 500px;
            width: 100%;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .legend {
            display: flex;
            gap: 30px;
            justify-content: center;
            flex-wrap: wrap;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 6px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-marker {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .marker-sprechstunde {
            background: var(--hauptblau);
        }
        
        .marker-event {
            background: #ffc107;
        }
        
        .contact-banner {
            background: var(--beruehigendes-gruen);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-top: 30px;
        }
        
        .contact-banner h3 {
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .contact-banner p {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .contact-links {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            font-size: 18px;
            font-weight: 500;
        }
        
        .contact-links a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            background: rgba(255,255,255,0.2);
        }
        
        .contact-links a:hover,
        .contact-links a:focus {
            background: rgba(255,255,255,0.3);
        }
        
        @media (max-width: 768px) {
            #map {
                height: 400px;
            }
        }
        
        .popup-content h3 {
            color: var(--hauptblau);
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .popup-content p {
            margin: 6px 0;
            font-size: 14px;
        }

        .popup-content .event-date {
            background: var(--beruehigendes-gruen);
            color: white;
            padding: 6px 10px;
            border-radius: 4px;
            display: inline-block;
            margin: 8px 0;
            font-weight: bold;
        }
        
        .popup-link {
            display: inline-block;
            margin-top: 10px;
            background: var(--hauptblau);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
        }
        
        .popup-link:hover {
            background: #0f3555;
        }
    </style>
</head>
<body>
    <!-- Skip-Link f√ºr Barrierefreiheit -->
    <a href="#main-content" class="skip-link">Zum Hauptinhalt springen</a>

    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-content">
            <div class="logo">
                <a href="index.html" aria-label="Zur Startseite von Digital im Alter Bremen-Nord">
                    <img src="images/dia-logo.png" 
                         alt="Digital im Alter Bremen-Nord Logo" 
                         width="175" 
                         height="100"
                         loading="eager">
                </a>
            </div>
            <div class="contact-info">
                <div>
                    <span class="visually-hidden">Telefonnummer: </span>
                    üìû <a href="tel:+491781603960" aria-label="Anrufen: 0178 1603960">+49 178 1603960</a>
                </div>
                <div>
                    <span class="visually-hidden">E-Mail: </span>
                    ‚úâ <a href="mailto:hallo@dia-bremen.de" aria-label="E-Mail senden an hallo@dia-bremen.de">hallo@dia-bremen.de</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav" role="navigation" aria-label="Hauptnavigation">
        <div class="nav-content">
            <ul>
                <li><a href="index.html">üè† Start</a></li>
                <li><a href="termine.html">üìÖ Termine</a></li>
                <li><a href="tipps.html">üíª Digitaler Alltag und Tipps</a></li>
                <li><a href="ueber.html">‚ÑπÔ∏è √úber Uns</a></li>
                <li><a href="kontakt.html">üìû Kontakt</a></li>
                <li><a href="standorte.html" class="active" aria-current="page">üó∫Ô∏è Standorte</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content" role="main">
        <!-- Hero Section -->
        <section class="hero" role="banner" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('images/header-karte.png'); background-size: cover; background-position: center 30%; background-attachment: scroll;">
            <div class="hero-content">
                <h1>üó∫Ô∏è Unsere Standorte in Bremen-Nord</h1>
                <p>Alle Sprechstunden, Kurse und Veranstaltungen auf einen Blick</p>
            </div>
        </section>

        <!-- Map Container -->
        <div class="map-container">
            <!-- Accessibility Banner -->
            <div class="a11y-banner" role="note" aria-label="Hinweis zur Barrierefreiheit">
                <strong>‚ôø Barrierefreiheit:</strong> Alle unsere Standorte sind barrierefrei zug√§nglich. 
                Die Karte kann mit Tastatur bedient werden (Tab + Enter). 
                F√ºr Screenreader steht eine vollst√§ndige Textliste zur Verf√ºgung.
            </div>
            
            <!-- Toggle f√ºr Listenansicht -->
            <button 
                id="toggleListBtn" 
                class="toggle-list-btn"
                aria-expanded="false"
                aria-controls="location-list"
            >
                <span id="toggleIcon">‚ñº</span>
                <span id="toggleText">Alle Standorte und Termine als Liste anzeigen</span>
            </button>
            
            <!-- Standortliste (barrierefrei) -->
            <div id="location-list" class="location-list" role="region" aria-label="Liste aller Standorte und Termine">
                <!-- Wird von JavaScript gef√ºllt -->
            </div>
            
            <!-- Karten-Sektion -->
            <section class="map-section" aria-labelledby="map-heading">
                <h2 id="map-heading">Interaktive Karte</h2>
                
                <!-- Kartensteuerung Instructions -->
                <div class="map-instructions" role="note">
                    <p><strong>üí° Karten-Bedienung:</strong></p>
                    <p>üñ±Ô∏è <strong>Mit Maus:</strong> Ziehen zum Verschieben, Mausrad zum Zoomen, Klick auf Marker f√ºr Details</p>
                    <p>‚å®Ô∏è <strong>Mit Tastatur:</strong> Tab-Taste zur Navigation, Enter zum √ñffnen, +/- zum Zoomen</p>
                    <p>üì± <strong>Auf Mobilger√§ten:</strong> Pinch-to-Zoom, Wischen zum Verschieben</p>
                </div>
                
                <!-- Die Karte -->
                <div id="map" role="application" aria-label="Interaktive Karte von Bremen-Nord mit Standorten und Terminen"></div>
                
                <!-- Legende -->
                <div class="legend" role="list" aria-label="Kartenlegende">
                    <div class="legend-item" role="listitem">
                        <div class="legend-marker marker-sprechstunde" aria-hidden="true"></div>
                        <span>Regelm√§√üige Sprechstunden</span>
                    </div>
                    <div class="legend-item" role="listitem">
                        <div class="legend-marker marker-event" aria-hidden="true"></div>
                        <span>Veranstaltungen & Kurse</span>
                    </div>
                </div>
            </section>
            
            <!-- Kontakt-Banner -->
            <div class="contact-banner">
                <h3>üìû Haben Sie Fragen oder m√∂chten sich anmelden?</h3>
                <p>Rufen Sie uns gerne an oder schreiben Sie uns eine E-Mail!</p>
                <div class="contact-links">
                    <a href="tel:+491781603960">üìû +49 178 1603960</a>
                    <a href="mailto:hallo@dia-bremen.de">‚úâÔ∏è hallo@dia-bremen.de</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Section Divider -->
    <div class="section-divider" aria-hidden="true"></div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo" id="footer-content">
        <div class="footer-content">
            <div class="footer-top">
                <section class="footer-about" aria-labelledby="about-heading">
                    <h3 id="about-heading">Digital im Alter Bremen-Nord</h3>
                    <p>Ein Projekt der Seniorenvertretung Bremen in Kooperation mit der Abteilung "Denksport & Digitales" der SG Mar√üel.</p>
                    <p>Unser Ziel ist es, √§lteren Menschen den Zugang zur digitalen Welt zu erleichtern und digitale Teilhabe f√ºr alle Generationen zu erm√∂glichen.</p>
                    <p><strong>Niemand soll digital abgeh√§ngt werden!</strong></p>
                </section>
                <nav class="footer-links" aria-labelledby="footer-nav-heading">
                    <h4 id="footer-nav-heading">Schnellzugriff</h4>
                    <ul role="list">
                        <li><a href="index.html"><span aria-hidden="true">üè†</span> Startseite</a></li>
                        <li><a href="termine.html"><span aria-hidden="true">üìÖ</span> Aktuelle Termine</a></li>
                        <li><a href="tipps.html"><span aria-hidden="true">üíª</span> Digitale Tipps</a></li>
                        <li><a href="ueber.html"><span aria-hidden="true">‚ÑπÔ∏è</span> √úber das Projekt</a></li>
                        <li><a href="kontakt.html"><span aria-hidden="true">üìû</span> Kontakt</a></li>
                    </ul>
                </nav>
                <section class="footer-contact" aria-labelledby="contact-heading">
                    <h4 id="contact-heading">Kontakt</h4>
                    <address>
                        <p><span aria-hidden="true">üìû</span> <a href="tel:+491781603960" aria-label="Telefonnummer anrufen">0178-1603960</a></p>
                        <p><span aria-hidden="true">‚úâ</span> <a href="mailto:hallo@dia-bremen.de" aria-label="E-Mail senden">hallo@dia-bremen.de</a></p>
                        <p><strong>Sprechzeiten:</strong><br>
                        <span aria-label="Mittwoch von 10 bis 11 Uhr">Mittwoch 10:00 - 11:00 Uhr</span></p>
                    </address>
                </section>
            </div>
            <div class="footer-bottom">
                <div class="footer-copyright">
                    <p>&copy; 2025 Digital im Alter Bremen-Nord - ‚ôø Barrierefrei gem√§√ü 
                    <abbr title="Web Content Accessibility Guidelines 2.1">WCAG 2.1 AA konform</abbr> ‚Äî 
                    <a href="barrierefrei.html#ausfuehrlich" aria-label="Ausf√ºhrliche Barrierefreiheitserkl√§rung lesen">Erkl√§rung lesen</a></p>
                </div>
                
                <nav class="footer-legal" aria-labelledby="legal-nav-heading">
                    <h4 id="legal-nav-heading" class="visually-hidden">Rechtliche Informationen</h4>
                    <a href="impressum.html" aria-label="Impressum aufrufen"><span aria-hidden="true">üìÑ</span> Impressum</a>
                    <a href="datenschutz.html" aria-label="Datenschutzerkl√§rung aufrufen"><span aria-hidden="true">üîí</span> Datenschutz</a>
                    <a href="bilderrechte.html" aria-label="Bilderrechte aufrufen"><span aria-hidden="true">üñºÔ∏è</span> Bilderrechte</a>
                </nav>
            </div>
        </div>
    </footer>
    
    <!-- Leaflet JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    
    <script>
        // Standort- und Termindaten
        const locations = [
            // REGELM√ÑSSIGE SPRECHSTUNDEN
            {
                id: 1,
                name: "Mittags-Sprechstunde",
                type: "sprechstunde",
                address: "Stadtbibliothek Lesum, Hindenburgstrasse 31, 28717 Bremen",
                lat: 53.1690925,
                lng: 8.6942379,
                phone: "+49 421 3617142",
                email: "hallo@dia-bremen.de",
                schedule: "Jeden 2. und 4. Freitag im Monat",
                hours: "11:00-13:00 Uhr",
                details: [
                    "Offene Sprechstunde - keine Anmeldung n√∂tig",
                    "Kostenlos",
                    "Eigenes Ger√§t mitbringen"
                ]
            },
            {
                id: 2,
                name: "Sprechstunde St.Magnus",
                type: "sprechstunde",
                address: "Begegnungszentrum St.Magnus, Unter den Linden 24, 28759 Bremen",
                lat: 53.1743451, 
                lng: 8.6617102,
                phone: "+49 421 621601",
                email: "hallo@dia-bremen.de",
                schedule: "Jeden 1. und 3. Donnerstag im Monat",
                hours: "15:00-17:00 Uhr",
                details: [
                    "Pers√∂nliche Beratung vor Ort",
                    "Kostenlos",
                    "Eigenes Ger√§t mitbringen"
                ]
            },
            {
                id: 3,
                name: "Sprechstunde Mar√üel",
                type: "sprechstunde",
                address: "Sportpark Mar√üel, Stader Landstra√üe 100, 28719 Bremen",
                lat: 53.1778883, 
                lng: 8.7297443,
                phone: "+49 157 73860418",
                email: "hallo@dia-bremen.de",
                schedule: "Montags",
                hours: "10:30-13:00 Uhr",
                details: [
                    "Telefonische Anmeldung n√∂tig",
                    "Individuelle Hilfe mit Ihrem Ger√§t",
                    "Kostenlos",
                    "Eigenes Ger√§t mitbringen"
                ]
            },
            {
                id: 4,
                name: "Apple f√ºr Fortgeschrittene",
                type: "sprechstunde",
                address: "Heimatverein Lesum, Alter Schulhof 11, 28717 Bremen",
                lat: 53.1687962, 
                lng: 8.6901158,
                phone: "+49 421 6361262",
                email: "hallo@dia-bremen.de",
                schedule: "Jeden 1. Montag im Monat",
                hours: "10:30-12:00 Uhr",
                details: [
                    "Anmeldung erforderlich",
                    "Kostenlos",
                    "Eigenes Ger√§t mitbringen"
                ]
            },
            {
                id: 5,
                name: "PC Treff B√ºrgerhaus",
                type: "sprechstunde",
                address: "B√ºrgerhaus Vegesack, Kirchheide 49, 28757 Bremen",
                lat: 53.1741582,  
                lng: 8.6174713,
                phone: "+49 421 6361262",
                email: "hallo@dia-bremen.de",
                schedule: "Donnerstags - 14-t√§gig",
                hours: "10:30-12:30 Uhr",
                details: [
                    "ACHTUNG: B√ºrgerhaus geschlossen",
                    "Fragen rund ums Smartphone und PC",
                    "Kostenlos",
                    "Einfach vorbeikommen"
                ]
            },
            
            
            // KOMMENDE VERANSTALTUNGEN
              {
                id: 9,
                name: "Tabletkurs f√ºr Anf√§nger",
                type: "event",
                address: "Sportpark Mar√üel, Stader Landstra√üe 100, 28719 Bremen",
                lat: 53.178008, 
                lng: 8.729443,
                phone: "+49 157 73860418",
                email: "hallo@dia-bremen.de",
                schedule: "Montags -leider AUSGEBUCHT",
                eventDate: "30. September 2025",
                hours: "10:30-13:00 Uhr",
                details: [
                    "Lernen Sie die Grundlagen im Umgang mit Tablets.",
                    "Tablets werden f√ºr den Kurs gestellt.",
                    "AUSGEBUCHT",
                    "Teilnehmerzahl: 6",
                    "Kostenlos"
                ]
            },
            {
                id: 8,
                name: "IPad Kurs f√ºr Anf√§nger",
                type: "event",
                address: "Stadtbibliothek Lesum, Hindenburgstrasse 31, 28717 Bremen",
                lat: 53.1694925,
                lng: 8.6945379,
                phone: "+49 421 3617142",
                email: "hallo@dia-bremen.de",
                schedule: "Dienstags -leider AUSGEBUCHT",
                eventDate: "21. Oktober 2025",
                hours: "11:30-13:00 Uhr",
                isUpcoming: false,
                details: [
                    "Lernen Sie die Grundlagen im Umgang mit Tablets.",
                    "Tablets werden f√ºr den Kurs gestellt.",
                    "Anmeldung erforderlich",
                    "Teilnehmerzahl: 6",
                    "Kostenlos"
                ]
            },
             {
                id: 10,
                name: "Tabletkurs f√ºr Anf√§nger",
                type: "event",
                address: "Begegnungszentrum Grambke,  Gr√∂nlandstra√üe 8, 28719 Bremen",
                lat: 53.1519993,  
                lng: 8.7132268,
                phone: "+49 421 641716",
                email: "hallo@dia-bremen.de",
                schedule: "Dienstags -leider AUSGEBUCHT",
                eventDate: "21. Oktober 2025",
                hours: " ",
                isUpcoming: false,
                details: [
                    "Lernen Sie die Grundlagen im Umgang mit Tablets.",
                    "Tablets werden f√ºr den Kurs gestellt.",
                    "AUSGEBUCHT",
                    "Teilnehmerzahl: 6",
                    "Kostenlos"
                ]
            },
            {
                id: 6,
                name: "WhatsApp Grundlagen Workshop",
                type: "event",
                address: "Stadtbibliothek Vegesack, Aumunder Heerweg 87, 28757 Bremen",
                lat: 53.1742271, 
                lng: 8.6202298,
                phone: "+49 178 1603960",
                email: "hallo@dia-bremen.de",
                eventDate: "23. Oktober 2025",
                hours: "11:30-13:00 Uhr",
                isUpcoming: true,
                details: [
                    "Lernen Sie WhatsApp von Grund auf kennen",
                    "Nachrichten, Bilder und Videoanrufe",
                    "Anmeldung erforderlich",
                    "Teilnehmerzahl: 15",
                    "Kostenlos"
                ]
            },
            {
                id: 7,
                name: "WhatsApp Grundlagen Workshop",
                type: "event",
                address: "Stadtbibliothek Lesum, Hindenburgstrasse 31, 28717 Bremen",
                lat: 53.1692925,
                lng: 8.6943379,
                phone: "+49 421 3617142",
                email: "hallo@dia-bremen.de",
                eventDate: "Termin im Dezember",
                hours: "11:30-13:00 Uhr",
                isUpcoming: true,
                details: [
                    "Lernen Sie WhatsApp von Grund auf kennen",
                    "Nachrichten, Bilder und Videoanrufe",
                    "Anmeldung erforderlich",
                    "Teilnehmerzahl: 15",
                    "Kostenlos"
                ]
            }
            
            
         
           
            
        ];
        
        // Karte initialisieren
        const map = L.map('map', {
            center: [53.185, 8.66],
            zoom: 13,
            zoomControl: true,
            keyboard: true,
            attributionControl: true
        });
        
        // OpenStreetMap Layer hinzuf√ºgen
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            maxZoom: 18
        }).addTo(map);
        
        // Custom Icons erstellen
        const sprechstundeIcon = L.divIcon({
            className: 'custom-marker',
            html: '<div style="background: #1a4971; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">üè¢</div>',
            iconSize: [30, 30],
            iconAnchor: [15, 15]
        });
        
        const eventIcon = L.divIcon({
            className: 'custom-marker',
            html: '<div style="background: #ffc107; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold; font-size: 16px;">üìÖ</div>',
            iconSize: [30, 30],
            iconAnchor: [15, 15]
        });
        
        // Marker hinzuf√ºgen
        locations.forEach(location => {
            const icon = location.type === 'sprechstunde' ? sprechstundeIcon : eventIcon;
            
            // Popup-Inhalt erstellen
            let popupContent = `<div class="popup-content"><h3>${location.name}</h3>`;
            
            if (location.eventDate) {
                popupContent += `<div class="event-date">üìÖ ${location.eventDate}</div>`;
            }
            
            popupContent += `<p><strong>üìç Adresse:</strong><br>${location.address}</p>`;
            
            if (location.schedule) {
                popupContent += `<p><strong>üîÑ Regelm√§√üig:</strong><br>${location.schedule}</p>`;
            }
            
            if (location.hours) {
                popupContent += `<p><strong>üïê Uhrzeit:</strong><br>${location.hours}</p>`;
            }
            
            if (location.details) {
                popupContent += `<p><strong>‚ÑπÔ∏è Details:</strong></p><ul style="margin: 8px 0; padding-left: 20px;">`;
                location.details.forEach(detail => {
                    popupContent += `<li style="margin: 4px 0;">${detail}</li>`;
                });
                popupContent += `</ul>`;
            }
            
            if (location.phone) {
                popupContent += `<p><strong>üìû Kontakt:</strong> <a href="tel:${location.phone}">${location.phone}</a></p>`;
            }
            
            popupContent += `
                <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location.address)}" 
                   target="_blank" 
                   rel="noopener noreferrer" 
                   class="popup-link">
                    Route berechnen ‚Üí
                </a>
            </div>`;
            
            const marker = L.marker([location.lat, location.lng], {
                icon: icon,
                title: location.name,
                alt: location.name,
                keyboard: true,
                riseOnHover: true
            }).addTo(map);
            
            marker.bindPopup(popupContent, {
                maxWidth: 350,
                className: 'accessible-popup'
            });
            
            marker.on('keypress', function(e) {
                if (e.originalEvent.key === 'Enter') {
                    this.openPopup();
                }
            });
        });
        
        // Liste generieren
        function generateLocationList() {
            const listContainer = document.getElementById('location-list');
            
            const sprechstunden = locations.filter(l => l.type === 'sprechstunde');
            const events = locations.filter(l => l.type === 'event');
            
            if (sprechstunden.length > 0) {
                const section = document.createElement('div');
                section.innerHTML = '<h3 style="color: #1a4971; font-size: 22px; margin: 20px 0 15px 0;">üè¢ Regelm√§√üige Sprechstunden</h3>';
                listContainer.appendChild(section);
                
                sprechstunden.forEach(location => {
                    const card = createLocationCard(location);
                    listContainer.appendChild(card);
                });
            }
            
            if (events.length > 0) {
                const section = document.createElement('div');
                section.innerHTML = '<h3 style="color: #1a4971; font-size: 22px; margin: 30px 0 15px 0;">üìÖ Kommende Veranstaltungen</h3>';
                listContainer.appendChild(section);
                
                events.forEach(location => {
                    const card = createLocationCard(location);
                    listContainer.appendChild(card);
                });
            }
        }
        
        function createLocationCard(location) {
            const card = document.createElement('article');
            card.className = 'location-card';
            
            let content = '';
            
            if (location.isUpcoming) {
                content += '<span class="event-badge upcoming">üìÖ Demn√§chst</span>';
            } else if (location.type === 'event') {
                content += '<span class="event-badge">üìÖ Veranstaltung - AUSGEBUCHT</span>';
            }
            
            content += `<h3>${location.type === 'sprechstunde' ? 'üè¢' : 'üìÖ'} ${location.name}</h3>`;
            
            if (location.eventDate) {
                content += `<p><strong>üìÖ Datum:</strong> ${location.eventDate}</p>`;
            }
            
            if (location.schedule) {
                content += `<p><strong>üîÑ Regelm√§√üig:</strong> ${location.schedule}</p>`;
            }
            
            if (location.hours) {
                content += `<p><strong>üïê Uhrzeit:</strong> ${location.hours}</p>`;
            }
            
            content += `<p><strong>üìç Adresse:</strong> ${location.address}</p>`;
            
            if (location.details) {
                content += '<p><strong>‚ÑπÔ∏è Details:</strong></p><ul style="margin: 8px 0 8px 20px;">';
                location.details.forEach(detail => {
                    content += `<li style="margin: 4px 0;">${detail}</li>`;
                });
                content += '</ul>';
            }
            
            if (location.phone) {
                content += `<p><strong>üìû Telefon:</strong> <a href="tel:${location.phone}">${location.phone}</a></p>`;
            }
            
            if (location.email) {
                content += `<p><strong>‚úâÔ∏è E-Mail:</strong> <a href="mailto:${location.email}">${location.email}</a></p>`;
            }
            
            card.innerHTML = content;
            return card;
        }
        
        // Toggle-Funktion f√ºr Liste
        const toggleBtn = document.getElementById('toggleListBtn');
        const locationList = document.getElementById('location-list');
        const toggleIcon = document.getElementById('toggleIcon');
        const toggleText = document.getElementById('toggleText');
        
        toggleBtn.addEventListener('click', function() {
            const isActive = locationList.classList.toggle('active');
            toggleBtn.setAttribute('aria-expanded', isActive);
            toggleIcon.textContent = isActive ? '‚ñ≤' : '‚ñº';
            toggleText.textContent = isActive ? 
                'Standort- und Terminliste ausblenden' : 
                'Alle Standorte und Termine als Liste anzeigen';
        });
        
        // Liste beim Laden generieren
        generateLocationList();
    </script>
</body>
</html>